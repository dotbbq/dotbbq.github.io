<!DOCTYPE html>


<html lang="zh-cn" data-theme="">
<head>
    
        
<meta charset="utf-8">
<meta name="HandheldFriendly" content="True">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer-when-downgrade">

<title>安装Nginx和ngx_pagespeed - UNIXETC</title>
<meta name="description" content="A Personal Site">

<link rel="icon" type="image/x-icon" href="https://unixetc.com/favicon.ico">
<link rel="apple-touch-icon-precomposed" href="https://unixetc.com/favicon.png">

<link rel="stylesheet" href="https://unixetc.com/css/light.css?rnd=1596103041" />
<style>

    [data-theme="dark"] {   
        --font-color: #eee;
--bg-color: #212121;

--link-color:#599ada;
--link-state-color:#ff5858;
--link-state-border-color: rgba(238, 54, 54, 0.5);

--thead-bg-color: #343a40;
--table-border-color: lightgrey;

--pre-color: #333;
--pre-bg-color: #f1f1f1;

--bq-color: #ccc;
--hr-color: #333;

--pagination-bg-color: #373737;
--pagination-link-color: #b6b6b6;

--post-info-color: grey;

--switcher-color: #333;
--switcher-bg-color: #fff;

    }

</style>

<link rel="stylesheet" href="https://unixetc.com/css/style.css?rnd=1596103041" />





<meta property="og:title" content="安装Nginx和ngx_pagespeed" />
<meta property="og:description" content="VPS配置:
Ubuntu 14.04 x86 RAM 512M SWAP 64M DISK 5G  准备工作 sudo apt-get update&amp;&amp;apt-get upgrade -y sudo apt-get install build-essential zlib1g-dev libpcre3 libpcre3-dev unzip libssl-dev -y  下载ngx_pagespeed cd NPS_VERSION=1.9.32.4 wget https://github.com/pagespeed/ngx_pagespeed/archive/release-${NPS_VERSION}-beta.zip unzip release-${NPS_VERSION}-beta.zip cd ngx_pagespeed-release-${NPS_VERSION}-beta/ wget https://dl.google.com/dl/page-speed/psol/${NPS_VERSION}.tar.gz tar -xzvf ${NPS_VERSION}.tar.gz  安装Nginx cd groupadd www useradd -s /sbin/nologin -g www www NGINX_VERSION=1.8.0 wget http://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz tar -xvzf nginx-${NGINX_VERSION}.tar.gz cd nginx-${NGINX_VERSION}/ ./configure \ --user=www \ --group=www \ --prefix=/usr/local/nginx \ --with-http_stub_status_module \ --with-http_ssl_module \ --with-http_spdy_module \ --with-http_gzip_static_module \ --with-http_sub_module \ --add-module=$HOME/ngx_pagespeed-release-${NPS_VERSION}-beta \ sudo make sudo make install sudo ln -sf /usr/local/nginx/sbin/nginx /usr/bin/nginx  配置/etc/init." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://unixetc.com/post/install-nginx-and-ngx_pagespeed-on-vps/" />
<meta property="article:published_time" content="2015-07-24T17:24:00+00:00" />
<meta property="article:modified_time" content="2015-07-24T17:24:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="安装Nginx和ngx_pagespeed"/>
<meta name="twitter:description" content="VPS配置:
Ubuntu 14.04 x86 RAM 512M SWAP 64M DISK 5G  准备工作 sudo apt-get update&amp;&amp;apt-get upgrade -y sudo apt-get install build-essential zlib1g-dev libpcre3 libpcre3-dev unzip libssl-dev -y  下载ngx_pagespeed cd NPS_VERSION=1.9.32.4 wget https://github.com/pagespeed/ngx_pagespeed/archive/release-${NPS_VERSION}-beta.zip unzip release-${NPS_VERSION}-beta.zip cd ngx_pagespeed-release-${NPS_VERSION}-beta/ wget https://dl.google.com/dl/page-speed/psol/${NPS_VERSION}.tar.gz tar -xzvf ${NPS_VERSION}.tar.gz  安装Nginx cd groupadd www useradd -s /sbin/nologin -g www www NGINX_VERSION=1.8.0 wget http://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz tar -xvzf nginx-${NGINX_VERSION}.tar.gz cd nginx-${NGINX_VERSION}/ ./configure \ --user=www \ --group=www \ --prefix=/usr/local/nginx \ --with-http_stub_status_module \ --with-http_ssl_module \ --with-http_spdy_module \ --with-http_gzip_static_module \ --with-http_sub_module \ --add-module=$HOME/ngx_pagespeed-release-${NPS_VERSION}-beta \ sudo make sudo make install sudo ln -sf /usr/local/nginx/sbin/nginx /usr/bin/nginx  配置/etc/init."/>








    
</head>
<body>
    <a class="skip-main" href="#main">Skip to main content</a>
    <div class="container">
        <header class="common-header"> 
            
                <h1 class="site-title">
    <a href="/">UNIXETC</a>
</h1>
<nav>
    
    
    <a class="" href="https://unixetc.com/tags/" title="">Tags</a>
    
    <a class="" href="https://unixetc.com/readme/" title="ReadMe">Readme</a>
    
</nav>

            
        </header>
        <main id="main" tabindex="-1"> 
            
    
    
    <article class="post">
        <header class="post-header">
            <h1 class="post-title">安装Nginx和ngx_pagespeed</h1>
        </header>
        <div class="content">
            <p>VPS配置:</p>
<pre><code>Ubuntu 14.04 x86
RAM 512M
SWAP 64M
DISK 5G
</code></pre>
<h4 id="准备工作">准备工作</h4>
<pre><code>sudo apt-get update&amp;&amp;apt-get upgrade -y
sudo apt-get install build-essential zlib1g-dev libpcre3 libpcre3-dev unzip libssl-dev -y
</code></pre>
<h3 id="下载ngx_pagespeed">下载ngx_pagespeed</h3>
<pre><code>cd
NPS_VERSION=1.9.32.4
wget https://github.com/pagespeed/ngx_pagespeed/archive/release-${NPS_VERSION}-beta.zip
unzip release-${NPS_VERSION}-beta.zip
cd ngx_pagespeed-release-${NPS_VERSION}-beta/
wget https://dl.google.com/dl/page-speed/psol/${NPS_VERSION}.tar.gz
tar -xzvf ${NPS_VERSION}.tar.gz 
</code></pre>
<h3 id="安装nginx">安装Nginx</h3>
<pre><code>cd
groupadd www
useradd -s /sbin/nologin -g www www
NGINX_VERSION=1.8.0
wget http://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz
tar -xvzf nginx-${NGINX_VERSION}.tar.gz
cd nginx-${NGINX_VERSION}/
./configure \
--user=www \
--group=www  \
--prefix=/usr/local/nginx \
--with-http_stub_status_module \
--with-http_ssl_module \
--with-http_spdy_module \
--with-http_gzip_static_module \
--with-http_sub_module \
--add-module=$HOME/ngx_pagespeed-release-${NPS_VERSION}-beta \

sudo make
sudo make install
sudo ln -sf /usr/local/nginx/sbin/nginx /usr/bin/nginx
</code></pre>
<p><strong>配置<code>/etc/init.d/nginx</code></strong></p>
<pre><code>sudo wget https://raw.github.com/JasonGiedymin/nginx-init-ubuntu/master/nginx -O /etc/init.d/nginx
sudo chmod +x /etc/init.d/nginx
</code></pre>
<p>管理Nginx服务</p>
<pre><code>service nginx {start|stop|restart|force-reload|reload|status|configtest|quietupgrade|terminate|destroy}
</code></pre>
<p>测试安装结果</p>
<pre><code>root@bwgvps:~# nginx -t
nginx: the configuration file /usr/local/nginx/conf/nginx.conf syntax is ok
nginx: configuration file /usr/local/nginx/conf/nginx.conf test is successful
</code></pre>
<h3 id="配置ngx_pagespeed">配置ngx_pagespeed</h3>
<p>编辑Nginx的配置文件(/usr/local/nginx/conf/nginx.conf)</p>
<p>在server段内添加<code>include gp.conf</code></p>
<p>在<code>/usr/local/nginx/conf/</code>内新建<code>gp.conf</code>,内容如下:</p>
<pre><code>pagespeed on;
pagespeed FileCachePath /usr/local/nginx/pagespeed/;
pagespeed RewriteLevel PassThrough;
pagespeed EnableFilters collapse_whitespace;
pagespeed EnableFilters canonicalize_javascript_libraries;
pagespeed EnableFilters combine_css;
pagespeed EnableFilters combine_javascript;
pagespeed EnableFilters elide_attributes;
pagespeed EnableFilters extend_cache;
pagespeed EnableFilters flatten_css_imports;
pagespeed CssFlattenMaxBytes 5120;
pagespeed EnableFilters lazyload_images;
pagespeed EnableFilters rewrite_javascript;
pagespeed EnableFilters rewrite_images;
pagespeed EnableFilters insert_dns_prefetch;
pagespeed EnableFilters prioritize_critical_css;	
</code></pre>
<p>Nginx reload后，用<code>curl</code>验证是否开启</p>
<pre><code>root@bwgvps:~# curl -I 127.0.0.1
HTTP/1.1 200 OK
Server: nginx/1.8.0
Content-Type: text/html
Connection: keep-alive
Date: Sat, 07 Feb 1970 00:54:49 GMT
X-Page-Speed: 1.9.32.4-7251
Cache-Control: max-age=0, no-cache
</code></pre>
<p>以上X-Page-Speed代表已经OK!</p>
<p><strong>参考:</strong></p>
<ul>
<li><a href="https://developers.google.com/speed/pagespeed/module/build_ngx_pagespeed_from_source">https://developers.google.com/speed/pagespeed/module/build_ngx_pagespeed_from_source</a></li>
<li><a href="https://github.com/JasonGiedymin/nginx-init-ubuntu">https://github.com/JasonGiedymin/nginx-init-ubuntu</a></li>
<li><a href="http://lnmp.org">http://lnmp.org</a></li>
</ul>

        </div>
        


<div class="post-info">
    
        <div class="post-date">2015-07-24</div>
    
    <div class="post-taxonomies">
        
            <ul class="post-categories">
                
                    <li><a href="https://unixetc.com/categories/STUFF">STUFF</a></li>
                
            </ul>
            
            
                <ul class="post-tags">
                    
                        <li><a href="https://unixetc.com/tags/linux">#Linux</a></li>
                    
                        <li><a href="https://unixetc.com/tags/google">#Google</a></li>
                    
                        <li><a href="https://unixetc.com/tags/nginx">#Nginx</a></li>
                    
                        <li><a href="https://unixetc.com/tags/vps">#VPS</a></li>
                    
                </ul>
        
    </div>
</div>

    </article>

    

    


        </main>
        
            <footer class="common-footer">
    
    

    <div class="copyright">
        <p>© Alair, 2020<br>
        Powered by <a target="_blank" rel="noopener noreferrer" href="https://gohugo.io/">Hugo</a>, theme <a target="_blank" rel="noopener noreferrer" href="https://github.com/mitrichius/hugo-theme-anubis">Anubis</a>.CDN by <a href="https://dwz.cn/juw2S2At" target="_blank">Qiniu</a>,Host by <a href="https://dwz.cn/CdAD0bNi" target="_blank">BWG</a>.<script type="text/javascript" src="//js.users.51.la/20892031.js"></script>
        </p>  
    </div> 

    


    
</footer>

        
    </div>
</body>
</html>

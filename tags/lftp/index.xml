<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>lftp on UNIXETC</title>
    <link>https://unixetc.com/tags/lftp/</link>
    <description>UNIXETC (lftp)</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Fri, 01 Apr 2016 14:21:00 +0000</lastBuildDate>
    
    <atom:link href="https://unixetc.com/tags/lftp/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>LFTP使用实例</title>
      <link>https://unixetc.com/post/lftp-use-case/</link>
      <pubDate>Fri, 01 Apr 2016 14:21:00 +0000</pubDate>
      
      <guid>https://unixetc.com/post/lftp-use-case/</guid>
      <description>&lt;h3 id=&#34;lftp介绍&#34;&gt;LFTP介绍&lt;/h3&gt;
&lt;p&gt;lftp是一个功能强大的ftp/http客户端，作者是 Alexander Lukyanov。&lt;/p&gt;
&lt;p&gt;lftp支持多种传输协议，如ftp、http、https、sftp、exp等。&lt;/p&gt;
&lt;p&gt;如同BASH一样，lftp支持任务管理。并且具备书签管理、内置镜像和多线程传送功能。&lt;/p&gt;
&lt;h3 id=&#34;使用lftp&#34;&gt;使用LFTP&lt;/h3&gt;
&lt;h4 id=&#34;登录服务器&#34;&gt;登录服务器&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;lftp ftp://user:password@ip:port
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;以上是一个完整的lftp登录示例，其中包含协议(ftp)、用户名(user)、密码(password)、主机(ip)以及端口(port)&lt;/p&gt;
&lt;p&gt;默认情况下lftp直接访问ftp服务，默认登录端口为22，因此我们可以使用以下方法来便捷登录主机&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;lftp user@ip
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;然后系统会提示输入&lt;strong&gt;password&lt;/strong&gt;，完成后登录成功！&lt;/p&gt;
&lt;h4 id=&#34;lftp命令行参数&#34;&gt;lftp命令行参数&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;lftp :~&amp;gt; help
    !&amp;lt;shell-command&amp;gt;                     (commands)
    alias [&amp;lt;name&amp;gt; [&amp;lt;value&amp;gt;]]             attach [PID]
    bookmark [SUBCMD]                    cache [SUBCMD]
    cat [-b] &amp;lt;files&amp;gt;                     cd &amp;lt;rdir&amp;gt;
    chmod [OPTS] mode file...            close [-a]
    [re]cls [opts] [path/][pattern]      debug [&amp;lt;level&amp;gt;|off] [-o &amp;lt;file&amp;gt;]
    du [options] &amp;lt;dirs&amp;gt;                  exit [&amp;lt;code&amp;gt;|bg]
    get [OPTS] &amp;lt;rfile&amp;gt; [-o &amp;lt;lfile&amp;gt;]      glob [OPTS] &amp;lt;cmd&amp;gt; &amp;lt;args&amp;gt;
    help [&amp;lt;cmd&amp;gt;]                         history -w file|-r file|-c|-l [cnt]
    jobs [-v] [&amp;lt;job_no...&amp;gt;]              kill all|&amp;lt;job_no&amp;gt;
    lcd &amp;lt;ldir&amp;gt;                           lftp [OPTS] &amp;lt;site&amp;gt;
    ln [-s] &amp;lt;file1&amp;gt; &amp;lt;file2&amp;gt;              ls [&amp;lt;args&amp;gt;]
    mget [OPTS] &amp;lt;files&amp;gt;                  mirror [OPTS] [remote [local]]
    mkdir [-p] &amp;lt;dirs&amp;gt;                    module name [args]
    more &amp;lt;files&amp;gt;                         mput [OPTS] &amp;lt;files&amp;gt;
    mrm &amp;lt;files&amp;gt;                          mv &amp;lt;file1&amp;gt; &amp;lt;file2&amp;gt;
    [re]nlist [&amp;lt;args&amp;gt;]                   open [OPTS] &amp;lt;site&amp;gt;
    pget [OPTS] &amp;lt;rfile&amp;gt; [-o &amp;lt;lfile&amp;gt;]     put [OPTS] &amp;lt;lfile&amp;gt; [-o &amp;lt;rfile&amp;gt;]
    pwd [-p]                             queue [OPTS] [&amp;lt;cmd&amp;gt;]
    quote &amp;lt;cmd&amp;gt;                          repeat [OPTS] [delay] [command]
    rm [-r] [-f] &amp;lt;files&amp;gt;                 rmdir [-f] &amp;lt;dirs&amp;gt;
    scache [&amp;lt;session_no&amp;gt;]                set [OPT] [&amp;lt;var&amp;gt; [&amp;lt;val&amp;gt;]]
    site &amp;lt;site-cmd&amp;gt;                      source &amp;lt;file&amp;gt;
    torrent [-O &amp;lt;dir&amp;gt;] &amp;lt;file|URL&amp;gt;...     user &amp;lt;user|URL&amp;gt; [&amp;lt;pass&amp;gt;]
    wait [&amp;lt;jobno&amp;gt;]                       zcat &amp;lt;files&amp;gt;
    zmore &amp;lt;files&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;常用的命令解释如下：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;远端操作&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ls 显示远端目录列表&lt;/li&gt;
&lt;li&gt;cd 切换远端目录&lt;/li&gt;
&lt;li&gt;get 下载文件&lt;/li&gt;
&lt;li&gt;put 上传文件&lt;/li&gt;
&lt;li&gt;mv 移动远端文件&lt;/li&gt;
&lt;li&gt;rm 删除远端文件&lt;/li&gt;
&lt;li&gt;pwd 显示远端目录&lt;/li&gt;
&lt;li&gt;du 计算远端目录大小&lt;/li&gt;
&lt;li&gt;退出&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;本地操作&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;!ls 显示本地目录列表&lt;/li&gt;
&lt;li&gt;lcd 切换本地目录&lt;/li&gt;
&lt;li&gt;lpwd 显示本地目录&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;lftp使用范例&#34;&gt;LFTP使用范例&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;登录服务器&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@hostus:~# lftp qxu1128@qxu1128.my3w.com
Password:
lftp qxu1128@qxu1128.my3w.com:~&amp;gt; ls
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;列出服务器目录文件&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;lftp qxu1128@qxu1128.my3w.com:/&amp;gt; ls
drwxr-xr-x    2 0        0            4096 Jan 23  2015 backup
drwxr-xr-x    2 675      100          4096 Jan 23  2015 cgi-bin
drwxr-xr-x    2 0        0            4096 Apr 01 03:40 ftplogs
drwxr-xr-x    4 675      100          4096 Apr 01 11:02 htdocs
drwxr-xr-x    2 675      100          4096 Jan 23  2015 myfolder
drwxr-xr-x    2 0        0            4096 Apr 01 02:03 wwwlogs
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;切换远端目录&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;lftp qxu1128@qxu1128.my3w.com:/&amp;gt; cd htdocs/
lftp qxu1128@qxu1128.my3w.com:/htdocs&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;上传文件&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;lftp qxu1128@qxu1128.my3w.com:/htdocs&amp;gt; put tb7302.apk
`tb7302.apk&#39; at 1913856 (24%) 77.7K/s eta:75s [Sending data]

7713808 bytes transferred in 78 seconds (97.0K/s)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;下载文件&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;lftp qxu1128@qxu1128.my3w.com:/htdocs&amp;gt; get bk.apk
`bk.apk&#39; at 124528 (1%) 28.1K/s eta:4m [Receiving data]

7713808 bytes transferred in 519 seconds (14.5K/s)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;上传文件夹&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;lftp qxu1128@qxu1128.my3w.com:/htdocs&amp;gt; mirror -R bootstrap/
Total: 4 directories, 14 files, 0 symlinks
New: 14 files, 0 symlinks
1079609 bytes transferred in 7 seconds (150.7 KiB/s)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;下载文件夹&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;lftp qxu1128@qxu1128.my3w.com:/htdocs&amp;gt; mirror bootstrap/ new
Total: 4 directories, 14 files, 0 symlinks
New: 14 files, 0 symlinks
1079609 bytes transferred in 6 seconds (189.9 KiB/s)
lftp qxu1142380172@qxu1142380172.my3w.com:/htdocs&amp;gt; !ls new/
css  fonts  js
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;中文乱码&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;有时由于编码问题，我们看到的中文可能是乱码，如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;lftp qxu1128@qxu1128.my3w.com:/&amp;gt; ls
drwxr-xr-x    2 0        0            4096 Jan 23  2015 backup
drwxr-xr-x    2 675      100          4096 Jan 23  2015 cgi-bin
drwxr-xr-x    2 0        0            4096 Apr 01 03:40 ftplogs
drwxr-xr-x    4 675      100          4096 Apr 01 11:02 htdocs
drwxr-xr-x    2 675      100          4096 Jan 23  2015 myfolder
drwxr-xr-x    2 0        0            4096 Apr 01 02:03 wwwlogs
-r-xr--r--    1 55961    100           606 Aug 31  2015 ▒▒▒ȶ▒▒▒.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;如果出现这种情况，就需要进行编码设置，如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;lftp qxu1128@qxu1128.my3w.com:/&amp;gt; set ftp:charset GBK
lftp qxu1128@qxu1128.my3w.com:/&amp;gt; set file:charset UTF-8
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;设置完成后再看：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;lftp qxu1128@qxu1128.my3w.com:/&amp;gt; ls
drwxr-xr-x    2 0        0            4096 Jan 23  2015 backup
drwxr-xr-x    2 675      100          4096 Jan 23  2015 cgi-bin
drwxr-xr-x    2 0        0            4096 Apr 01 03:40 ftplogs
drwxr-xr-x    4 675      100          4096 Apr 01 11:33 htdocs
drwxr-xr-x    2 675      100          4096 Jan 23  2015 myfolder
drwxr-xr-x    2 0        0            4096 Apr 01 02:03 wwwlogs
-r-xr--r--    1 55961    100           606 Aug 31  2015 请先读我.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;以上两条&lt;strong&gt;set&lt;/strong&gt;命令可以写入lftp配置文件，以方便以后使用，关于lftp配置文件参考下节介绍。&lt;/p&gt;
&lt;h4 id=&#34;lftp书签使用方法&#34;&gt;LFTP书签使用方法&lt;/h4&gt;
&lt;p&gt;我们可以使用书签来存储一些商用的ftp登录信息，lftp的书签文件为&lt;code&gt;~/.lftp/bookmarks&lt;/code&gt;，我们可以编辑它来添加书签&lt;/p&gt;
&lt;p&gt;lftp书签格式如下&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;bkname ftp://user:password@ip:port
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;设置好书签后，可以使用&lt;code&gt;lftp&lt;/code&gt;加书签名来登录&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;lftp bkname
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;书签使用示例：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@hostus:~# cat ~/.lftp/bookmarks
aliyun ftp://qxu172@qxu150172.my3w.com
root@hostus:~# lftp aliyun
Password:
lftp qxu1128@qxu1128.my3w.com:~&amp;gt; ls
drwxr-xr-x    2 0        0            4096 Jan 23  2015 backup
drwxr-xr-x    2 675      100          4096 Jan 23  2015 cgi-bin
drwxr-xr-x    2 0        0            4096 Apr 01 03:40 ftplogs
drwxr-xr-x    4 675      100          4096 Apr 01 11:33 htdocs
drwxr-xr-x    2 675      100          4096 Jan 23  2015 myfolder
drwxr-xr-x    2 0        0            4096 Apr 01 02:03 wwwlogs
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;lftp配置文件&#34;&gt;LFTP配置文件&lt;/h3&gt;
&lt;p&gt;lftp执行配置文件顺序为&lt;code&gt;/etc/lftp.conf&lt;/code&gt;、&lt;code&gt;~/.lftprc&lt;/code&gt;、&lt;code&gt;~/.lftp/rc&lt;/code&gt;，我们可以编辑这些修改这些文件，来达到全局配置或者用户自定义配置。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;set&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;在设置文件中，使用set来设置一些变量的值，如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;set ftp:ssl-force on
set ssl:verify-certificate on
set ftp:use-feat off
set ftp:ssl-protect-data on
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;debug&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;默认情况下lftp是静默提示的，如果需要查看一些提示信息，就要对&lt;strong&gt;debug&lt;/strong&gt;进行设置&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;debug 5 显示所有调试信息&lt;/li&gt;
&lt;li&gt;debug 3 仅显示欢迎信息和错误信息&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;alias&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;定义命令别名，比如为ls设置别名dir以方便个人使用习惯，如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;alias dir ls
alias less more
alias zless zmore
alias bzless bzmore
alias reconnect &amp;quot;close; cache flush; cd .&amp;quot;
alias edit &amp;quot;eval -f &amp;quot;get $0 -o ~/.lftp/edit.tmp.$$ &amp;amp;&amp;amp; shell \\&amp;quot;cp -p ~/.lftp/edit.tmp.$$ ~/.lftp/edit.tmp.$$.orig &amp;amp;&amp;amp; vim ~/.lftp/edit.tmp.$$ &amp;amp;&amp;amp; test ~/.lftp/edit.tmp.$$ -nt ~/.lftp/edit.tmp.$$.orig\\&amp;quot; &amp;amp;&amp;amp; put ~/.lftp/edit.tmp.$$ -o $0; shell rm -f ~/.lftp/edit.tmp.$$*&amp;quot;&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
  </channel>
</rss>
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>GRUB on UNIXETC</title>
    <link>https://unixetc.com/tags/grub/</link>
    <description>UNIXETC (GRUB)</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh</language>
    <lastBuildDate>Sun, 08 Jul 2018 17:18:00 +0000</lastBuildDate>
    
    <atom:link href="https://unixetc.com/tags/grub/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>GRUB引导ISO镜像</title>
      <link>https://unixetc.com/post/grub-boot-iso-image-file/</link>
      <pubDate>Sun, 08 Jul 2018 17:18:00 +0000</pubDate>
      
      <guid>https://unixetc.com/post/grub-boot-iso-image-file/</guid>
      <description>&lt;p&gt;家里电脑安装了双系统(Xubuntu+Windows7)，平时一直不关机，开着TeamViewer便于在办公室远程操作。&lt;/p&gt;
&lt;p&gt;这次不知怎么回事儿，远程掉了，回家一看Windows意外关机，再开机直接蓝屏。&lt;/p&gt;
&lt;p&gt;由于为了省资源，关闭了系统保护，没法进行还原，多次试着拯救都没能解决，无限蓝屏……&lt;/p&gt;
&lt;p&gt;手头刚好没有WinPE的U盘，没法ghost恢复或重装Windows，只有xubuntu可用，一筹莫展。&lt;/p&gt;
&lt;p&gt;突然想到grub是否可以引导iso？ 网上找了下，还真可以，于是下载了个WinPE镜像文件，打算通过grub来引导以修复Windows。&lt;/p&gt;
&lt;p&gt;具体操作如下：&lt;/p&gt;
&lt;p&gt;安装&lt;strong&gt;grub-imageboot&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;alair@e6440:~$ apt search memdisk
正在排序... 完成
全文搜索... 完成  
grub-imageboot/bionic,bionic 0.6 all
boot iso, harddisk and floppy images with grub2 and syslinux memdisk

alair@e6440:~$ sudo apt install grub-imageboot
[sudo] alair 的密码： 
正在读取软件包列表... 完成
正在分析软件包的依赖关系树       
正在读取状态信息... 完成       
将会同时安装下列软件：
syslinux-common
下列【新】软件包将被安装：
grub-imageboot syslinux-common
升级了 0 个软件包，新安装了 2 个软件包，要卸载 0 个软件包，有 4 个软件包未被升级。
需要下载 1,176 kB 的归档。
解压缩后会消耗 3,684 kB 的额外空间。
您希望继续执行吗？ [Y/n] y
获取:1 http://mirrors.cqu.edu.cn/ubuntu bionic/main amd64 syslinux-common all 3:6.03+dfsg1-2 [1,171 kB]
获取:2 http://mirrors.cqu.edu.cn/ubuntu bionic/universe amd64 grub-imageboot all 0.6 [4,424 B]
已下载 1,176 kB，耗时 1秒 (1,947 kB/s)
正在选中未选择的软件包 syslinux-common。
(正在读取数据库 ... 系统当前共安装有 181845 个文件和目录。)
正准备解包 .../syslinux-common_3%3a6.03+dfsg1-2_all.deb  ...
正在解包 syslinux-common (3:6.03+dfsg1-2) ...
正在选中未选择的软件包 grub-imageboot。
正准备解包 .../grub-imageboot_0.6_all.deb  ...
正在解包 grub-imageboot (0.6) ...
正在设置 syslinux-common (3:6.03+dfsg1-2) ...
正在设置 grub-imageboot (0.6) ...
Copy syslinux memdisk to /boot/memdisk
alair@e6440:~$ 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;下载WinPE镜像文件(efi.iso)，拷贝至&lt;code&gt;/boot/&lt;/code&gt;目录&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;alair@e6440:~$sudo cp efi.iso /boot/
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;编辑&lt;code&gt;/etc/grub.d/40_custom&lt;/code&gt;文件，加入以下内容：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;menuentry &amp;quot;WinPE&amp;quot; { 
linux16 /boot/memdisk iso raw
initrd16 /boot/efi.iso
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;运行&lt;code&gt;sudo update-grub&lt;/code&gt;使设置生效，完成后重启时grub中会出现&lt;strong&gt;WinPE&lt;/strong&gt;菜单，选择该项则加载自定义winpe镜像，下来就在WinPE下恢复Windows系统咯!!!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ubuntu修改grub引导菜单</title>
      <link>https://unixetc.com/post/ubuntu-modify-the-grub-boot-menu/</link>
      <pubDate>Mon, 27 Jun 2016 17:42:00 +0000</pubDate>
      
      <guid>https://unixetc.com/post/ubuntu-modify-the-grub-boot-menu/</guid>
      <description>&lt;p&gt;先运行&lt;code&gt;update-grub&lt;/code&gt;命令生成一次grub配置，顺便查看一下识别出来的引导菜单内容&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@alairpc:~# update-grub
Generating grub configuration file ...
Found linux image: /boot/vmlinuz-4.4.0-21-generic
Found initrd image: /boot/initrd.img-4.4.0-21-generic
Found memtest86+ image: /boot/memtest86+.elf
Found memtest86+ image: /boot/memtest86+.bin
Found Windows 7 (loader) on /dev/sda1
done
root@alairpc:~# 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;注意看，以上共有5个菜单项，最后一个是windows7&lt;/p&gt;
&lt;p&gt;接下来我们来看看gurb配置文件&lt;code&gt;/etc/default/grub&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@alairpc:~# cat /etc/default/grub 
# If you change this file, run &#39;update-grub&#39; afterwards to update
# /boot/grub/grub.cfg.
# For full documentation of the options in this file, see:
#   info -f grub -n &#39;Simple configuration&#39;

GRUB_DEFAULT=4
#GRUB_HIDDEN_TIMEOUT=0
GRUB_HIDDEN_TIMEOUT_QUIET=true
GRUB_TIMEOUT=3
GRUB_DISTRIBUTOR=`lsb_release -i -s 2&amp;gt; /dev/null || echo Debian`
GRUB_CMDLINE_LINUX_DEFAULT=&amp;quot;quiet splash&amp;quot;
GRUB_CMDLINE_LINUX=&amp;quot;locale=zh_CN&amp;quot;

# Uncomment to enable BadRAM filtering, modify to suit your needs
# This works with Linux (no patch required) and with any kernel that obtains
# the memory map information from GRUB (GNU Mach, kernel of FreeBSD ...)
#GRUB_BADRAM=&amp;quot;0x01234567,0xfefefefe,0x89abcdef,0xefefefef&amp;quot;

# Uncomment to disable graphical terminal (grub-pc only)
#GRUB_TERMINAL=console

# The resolution used on graphical terminal
# note that you can use only modes which your graphic card supports via VBE
# you can see them in real GRUB with the command `vbeinfo&#39;
#GRUB_GFXMODE=640x480

# Uncomment if you don&#39;t want GRUB to pass &amp;quot;root=UUID=xxx&amp;quot; parameter to Linux
#GRUB_DISABLE_LINUX_UUID=true

# Uncomment to disable generation of recovery mode menu entries
#GRUB_DISABLE_RECOVERY=&amp;quot;true&amp;quot;

# Uncomment to get a beep at grub start
#GRUB_INIT_TUNE=&amp;quot;480 440 1&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;其中&lt;strong&gt;GRUB_DEFAULT&lt;/strong&gt;就是默认引导项，这里设置为4,对应的为windows7,说明一下，这个引导序列号是从0开始排的，所以第五项window7的序列号应为为4&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;GRUB_TIMEOUT&lt;/strong&gt;表示菜单等待时间，单位为秒(s)&lt;/p&gt;
&lt;p&gt;还值得说明的是&lt;strong&gt;GRUB_GFXMODE&lt;/strong&gt;，设置grub显示的分辨率&lt;/p&gt;
&lt;p&gt;自定义编辑完grub配置文件后，运行&lt;code&gt;update-grub&lt;/code&gt;使配置生效即可。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Centos7配置grub添加windows引导菜单</title>
      <link>https://unixetc.com/post/centos7-configuration-grub-to-add-the-windows-boot-menu/</link>
      <pubDate>Sat, 09 Aug 2014 08:09:00 +0000</pubDate>
      
      <guid>https://unixetc.com/post/centos7-configuration-grub-to-add-the-windows-boot-menu/</guid>
      <description>&lt;p&gt;进入&lt;code&gt;/etc/grub.d/&lt;/code&gt;目录&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#cd /etc/grub.d/
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;新建&lt;code&gt;15_Windows&lt;/code&gt;文件，写入以下内容：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#! /bin/sh -e
echo &amp;quot;#Adding Windows&amp;quot; &amp;gt;&amp;amp;2
cat &amp;lt;&amp;lt; EOF
menuentry &amp;quot;Windows&amp;quot; {
set root=(hd0,1)
chainloader +1
}
EOF
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;其中(hd0,1)是本地磁盘windows主扇区号，可以通过&lt;code&gt;fdisk -l&lt;/code&gt;来查看确定。&lt;/p&gt;
&lt;p&gt;设定文件权限&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#chmod 755 15_Windows
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;编辑&lt;code&gt;/etc/default/grub&lt;/code&gt;来设定菜单等待时间&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GRUB_TIMEOUT=2
GRUB_DISTRIBUTOR=&amp;quot;$(sed &#39;s, release .*$,,g&#39; /etc/system-release)&amp;quot;
GRUB_DEFAULT=saved
GRUB_DISABLE_SUBMENU=true
GRUB_TERMINAL_OUTPUT=&amp;quot;console&amp;quot;
GRUB_CMDLINE_LINUX=&amp;quot;vconsole.keymap=us crashkernel=auto  vconsole.font=latarcyrheb-sun16 rhgb quiet&amp;quot;
GRUB_DISABLE_RECOVERY=&amp;quot;true&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;修改&lt;strong&gt;GRUB_TIMEOUT&lt;/strong&gt;值即可。&lt;/p&gt;
&lt;p&gt;设置Windows为默认启动项&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#grub2-set-default &amp;quot;windows&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;然后运行以下命令，使以上修改生效：&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# grub2-mkconfig -o /boot/grub2/grub.cfg&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>修复grub引导</title>
      <link>https://unixetc.com/post/repair-grub-boot/</link>
      <pubDate>Thu, 12 Dec 2013 12:13:00 +0000</pubDate>
      
      <guid>https://unixetc.com/post/repair-grub-boot/</guid>
      <description>&lt;p&gt;笔记本原来安装的Linux/Windows XP双系统，今天重新安装了Windows7，但是开机的grub引导被搞掉了，找了下grub的man看了半天，摸索出来如何修复原来的grub引导。&lt;/p&gt;
&lt;p&gt;首先，使用Linux live cd引导系统，然后按照以下操作：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;检查分区信息&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ubuntu@ubuntu:~$ sudo -s
root@ubuntu:~# lsblk 
NAME    MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
sda       8:0    0 465.8G  0 disk 
├─sda1    8:1    0    40G  0 part 
├─sda2    8:2    0     1K  0 part 
├─sda5    8:5    0     4G  0 part [SWAP]
├─sda6    8:6    0    20G  0 part 
├─sda7    8:7    0    20G  0 part 
├─sda8    8:8    0   100G  0 part 
├─sda9    8:9    0   200G  0 part 
└─sda10   8:10   0  81.8G  0 part 
sr0      11:0    1   1.6G  0 rom  /cdrom
loop0     7:0    0   1.5G  1 loop /rofs
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;以上的sda6是我的/home目录，根目录为sda7&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;挂载相应分区，重新安装grub&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@ubuntu:~# mount /dev/sda7 /mnt/
root@ubuntu:~# mount /dev/sda6 /mnt/home/
root@ubuntu:~# grub-install --root-directory=/mnt/ /dev/sda
Installation finished. No error reported.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;至此所有操作完成，重启后即可看到原来的引导菜单。&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>